!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e,t,s){},function(e,t,s){"use strict";s.r(t);s(0);var i=class{constructor(){this.goRight=()=>{this.currentIndex<this.images.length-1?(clearInterval(this.intervalles),this.previousIndex=this.currentIndex,this.currentIndex++,this.images[this.currentIndex].classList.add("show"),this.images[this.previousIndex].classList.remove("show")):(clearInterval(this.intervalles),this.previousIndex=this.currentIndex,this.currentIndex=0,this.images[this.currentIndex].classList.add("show"),this.images[this.previousIndex].classList.remove("show"),clearInterval(this.intervalles)),this.intervalles=setInterval(this.goRight,3e3)},this.goLeft=()=>{0===this.currentIndex?(clearInterval(this.intervalles),this.previousIndex=this.currentIndex,this.currentIndex=this.images.length-1,this.images[this.currentIndex].classList.add("show"),this.images[this.previousIndex].classList.remove("show")):(clearInterval(this.intervalles),this.previousIndex=this.currentIndex,this.currentIndex--,this.images[this.currentIndex].classList.add("show"),this.images[this.previousIndex].classList.remove("show")),this.intervalles=setInterval(this.goRight,3e3)},this.putPauseOrPlay=()=>{!0===this.click?(clearInterval(this.intervalles),this.click=!1,this.pauseButton.style.display="none",this.playButton.style.display="block"):(this.click=!0,this.pauseButton.style.display="block",this.playButton.style.display="none",this.intervalles=setInterval(this.goRight,3e3))},this.container=document.getElementById("carrousel"),this.images=document.querySelectorAll(".carrousel__content"),this.rightButton=document.getElementById("js-carrousel__buttons-right"),this.leftButton=document.getElementById("js-carrousel__buttons-left"),this.pauseButton=document.getElementById("js-carrousel__buttons-pause"),this.playButton=document.getElementById("js-carrousel__buttons-play"),this.currentIndex=0,this.previousIndex=0,this.click=!0,this.intervalles=setInterval(this.goRight,3e3),this.rightButton.addEventListener("click",this.goRight),this.leftButton.addEventListener("click",this.goLeft),this.pauseButton.addEventListener("click",this.putPauseOrPlay),this.playButton.addEventListener("click",this.putPauseOrPlay)}},n=s.p+"img/svg/station.svg";var o=class{constructor(){this.initMap=()=>{this.map=L.map(this.mapContainer).setView([45.75,4.85],15);let e=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:13,maxZoom:17,attribution:'&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'});this.map.addLayer(e)},this.getDataFromApi=()=>new Promise((e,t)=>{let s=new XMLHttpRequest;s.onreadystatechange=()=>{if(4===s.readyState)if(200===s.status){let t=JSON.parse(s.responseText);e(t)}else t("Erreur")},s.open("GET",this.api),s.send()}),this.addMarkers=e=>{e.forEach(e=>{let t=L.icon({iconUrl:n,iconSize:[30,30],iconAnchor:[e.position.lat,e.position.lng]});L.marker([e.position.lat,e.position.lng],{icon:t}).addTo(this.map).addEventListener("click",()=>{this.currentStation=e,""!=e.address?this.address.innerHTML=e.address.charAt(0).toUpperCase()+e.address.substring(1).toLowerCase():(this.address.innerHTML="Adresse non reconnue",this.bikesNumber.style.color="#F20746",e.available_bikes=0,this.bikesNumber.innerHTML=0),this.bikesNumber.innerHTML=e.available_bikes,e.available_bikes>0?(this.address.style.color="#20284F",this.bikesNumber.style.color="#20284F"):(this.address.style.color="#8D8D8D",this.bikesNumber.style.color="#F20746")})})},this.api="https://api.jcdecaux.com/vls/v1/stations?contract=Lyon&apiKey=6dd524dd35fde93005f7e4806b82374aedc7864f",this.mapContainer=document.getElementById("js-map"),this.map=null,this.address=document.getElementById("js-reservation__address"),this.bikesNumber=document.getElementById("js-reservation__illustrations-number"),this.currentStation=null,this.initMap(),this.getDataFromApi().then(e=>{this.addMarkers(e)})}};var a=class{constructor(){this.activateEvents=()=>{this.canvas.addEventListener("mousedown",e=>{this.signatureOk=!0,this.lastPosition=this.getMousePosition(e),this.validationButtonPopin.style.backgroundColor="#56CCCE",this.validationButtonPopin.disabled=!1}),this.canvas.addEventListener("mousemove",e=>{this.mousePosition=this.getMousePosition(e),this.canvasSignature()}),document.addEventListener("mouseup",e=>{this.signatureOk=!1})},this.canvas=document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.validationButtonPopin=document.getElementById("popin__validation"),this.signatureOk=!1,this.mousePosition={x:0,y:0},this.lastPosition=this.mousePosition,this.validationButtonPopin.disabled=!0,this.activateEvents()}getMousePosition(e){if(this.signatureOk){let t=this.canvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}}canvasSignature(){this.signatureOk&&(this.context.beginPath(),this.context.moveTo(this.lastPosition.x,this.lastPosition.y),this.context.lineTo(this.mousePosition.x,this.mousePosition.y),this.context.stroke(),this.context.strokeStyle="#56CCCE",this.context.lineWidth=3,this.lastPosition=this.mousePosition)}};var r=class{constructor(){this.checkRegExInput=(e,t)=>{0==e.value.length?(e.style.borderBottom="1px solid #CACACA",this.checkStateInput(!1,t)):!this.regex.test(e.value)||e.value.length<=1?(e.style.borderBottom="1px solid #F20746",e.style.color="#F20746",this.checkStateInput(!1,t)):(e.style.borderBottom="1px solid #56CCCE",e.style.color="#56CCCE",this.checkStateInput(!0,t),localStorage.setItem(t,e.value)),this.activateButtonReservation()},this.checkStateInput=(e,t)=>{"userName"===t?this.correctName=e:"userSurname"===t&&(this.correctSurname=e)},this.activateButtonReservation=()=>{1==this.correctName&&1==this.correctSurname&&1==this.bikeAvailable&&"flex"!=this.bookingArea.style.display?(this.reservationButton.disabled=!1,this.reservationButton.style.backgroundColor="#56CCCE"):(this.reservationButton.disabled=!0,this.reservationButton.style.backgroundColor="#CACACA")},this.afficherCanvas=()=>{this.changeStylePopin("flex","block","fixed","rgba(0, 0, 0, 0.5)","2000");new a},this.changeStylePopin=(e,t,s,i,n)=>{this.popIn.style.display=e,this.overlay.style.display=t,this.overlay.style.position=s,this.overlay.style.backgroundColor=i,this.overlay.style.zIndex=n},this.changeStyleBooking=()=>{this.bookingArea.style.display="flex",this.bookingArea.style.zIndex="1000",this.inputName.style.borderBottom="1px solid #CACACA",this.inputSurname.style.borderBottom="1px solid #CACACA",this.reservationButton.style.backgroundColor="#CACACA",this.bikesNumber.innerHTML="0",this.address.innerHTML="Adresse de la station",this.bikesNumber.style.color="#8D8D8D",this.address.style.color="#8D8D8D"},this.decompteTemps=()=>{this.minutesParagraph.innerHTML=this.minutes,this.secondesParagraph.innerHTML=this.secondes,this.stockDatasMinutes(),this.intervalToClear=setInterval(()=>{this.secondes>=1?(this.secondes--,this.secondesParagraph.innerHTML=this.secondes,this.stockDatasSecondes(),this.secondes<10&&(this.secondesParagraph.innerHTML="0"+this.secondes)):(this.secondes=59,this.secondesParagraph.innerHTML=this.secondes,this.minutes>0&&(this.minutes--,this.minutesParagraph.innerHTML=this.minutes,this.stockDatasMinutes(),this.minutes<10&&(this.minutesParagraph.innerHTML="0"+this.minutes))),0==this.minutes&&0==this.secondes&&(clearInterval(this.intervalToClear),this.bookingArea.style.display="none")},1e3)},this.stockDatasMinutes=()=>{sessionStorage.setItem("minutes",this.minutes)},this.stockDatasSecondes=()=>{sessionStorage.setItem("secondes",this.secondes)},this.keepReservationRunning=()=>{localStorage.getItem("userSurname")&&localStorage.getItem("userName")&&sessionStorage.getItem("addressValue")&&sessionStorage.getItem("minutes")&&sessionStorage.getItem("secondes")&&0!=sessionStorage.getItem("secondes")&&0!=sessionStorage.getItem("minutes")&&(this.changeStyleBooking(),this.userSurname.innerHTML=localStorage.getItem("userSurname"),this.userName.innerHTML=localStorage.getItem("userName"),this.registeredAddress.innerHTML=sessionStorage.getItem("addressValue").toLowerCase(),this.minutes=sessionStorage.getItem("minutes"),this.secondes=sessionStorage.getItem("secondes"),this.decompteTemps())},this.cancelCountdown=()=>{clearInterval(this.intervalToClear),this.bookingArea.style.display="none",sessionStorage.removeItem("addressValue"),sessionStorage.removeItem("minutes"),sessionStorage.removeItem("secondes")},this.map=document.getElementById("js-map"),this.address=document.getElementById("js-reservation__address"),this.bikesNumber=document.getElementById("js-reservation__illustrations-number"),this.inputSurname=document.getElementById("form__surname-input"),this.inputName=document.getElementById("form__name-input"),this.reservationButton=document.getElementById("js-form__submit"),this.footer=document.getElementById("footer"),this.correctSurname=null,this.correctName=null,this.bikeAvailable=null,this.regex=/^[A-Za-zàäâéèëêïîôùüÿçœ\'-]+$/,this.minutes=19,this.secondes=59,this.addressValue=null,this.popIn=document.getElementById("popin"),this.overlay=document.getElementById("overlay"),this.validationButtonPopin=document.getElementById("popin__validation"),this.bookingArea=document.getElementById("section-booking"),this.minutesParagraph=document.getElementById("minutes-paragraph"),this.secondesParagraph=document.getElementById("secondes-paragraph"),this.registeredAddress=document.getElementById("userInfos__registered-address"),this.userName=document.getElementById("userInfos__registered-userName"),this.userSurname=document.getElementById("userInfos__registered-userSurname"),this.annulationButton=document.getElementById("annulation__button"),this.maMap=new o,this.keepReservationRunning(),this.reservationButton.disabled=!0,this.inputSurname.addEventListener("input",()=>{this.checkRegExInput(this.inputSurname,"userSurname")}),this.inputName.addEventListener("input",()=>{this.checkRegExInput(this.inputName,"userName")}),this.map.addEventListener("click",()=>{this.maMap.currentStation&&(this.maMap.currentStation.available_bikes?(this.bikeAvailable=!0,this.activateButtonReservation()):(this.bikeAvailable=!1,this.activateButtonReservation()))}),this.reservationButton.addEventListener("click",e=>{e.preventDefault(),this.afficherCanvas()}),this.validationButtonPopin.addEventListener("click",e=>{e.preventDefault(),this.changeStylePopin("none","none","none","none","-40"),this.changeStyleBooking(),this.inputSurname.removeAttribute(localStorage.getItem("userSurname")),this.inputName.removeAttribute(localStorage.getItem("userName")),this.decompteTemps(),this.userSurname.innerHTML=localStorage.getItem("userSurname"),this.userName.innerHTML=localStorage.getItem("userName"),this.addressValue=this.maMap.currentStation.address,this.registeredAddress.innerHTML=this.addressValue.toLowerCase(),sessionStorage.setItem("addressValue",this.addressValue)}),this.annulationButton.addEventListener("click",()=>{this.cancelCountdown(),document.location.reload(!0)})}};new i,new r}]);